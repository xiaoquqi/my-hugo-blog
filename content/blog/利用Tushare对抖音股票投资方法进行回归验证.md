---
title: 利用Tushare对一夜持股法进行回归验证
author: 孙琦(Ray)
date: 2021-07-01 18:23:09
tags:
---
最近在抖音看到很多金融博主在推荐一些投资股票的心得，可以说是五花八门，再看评论区，更是千奇百怪，大部分人都在说没用，但又拿不出什么证据来。事实是检验真理的唯一标准，我觉得对于此类投资观点，最好的方式进行用历史数据去验证，因为历史总是重复的，如果是对的，那么对于未来的投资也算是找到了一条生财之道。

<!-- more -->

## 关于一夜持股法

简单来说，一夜持股法是利用两天之间的追涨来获取收益，即第一天尾盘买入股票，第二天趁着涨势再卖掉，降低盘中震荡对于价格的冲击，如此反复操作，获取收益。

在原文视频中，作者给出了这种操作的八个条件：

* 在收盘前，即下午2点半左右看盘
* 在当天的股票中，利用软件筛选出涨幅在3%-5%的股票
* 再根据量比排名，找出大于1的股票
* 再根据换手率排名，选出换手率在5%-10%的股票，换手率太高可能有庄家出货嫌疑，换手率太低第二天缺乏上攻的动力
* 再根据流通盘排名，筛选出50亿-200亿之间的股票，股票流通盘太大，拉动需要大量资金
* 查看K线图，删除成交量忽高忽低的，只留下成交量持续放大的股票
* 观察K线形态，如果在重要均线下方，或者近期冲高回落有套牢盘的全部删掉，只留下K线上方没有任何压力的，第二天冲高概率才大
* 观察当天分时图，股价全天必须在分时图均线价格上方，那么意味着所有人都吃到了涨幅，第二天冲高有动力；股票价格必须要强于当天的大盘分时图，选择逆势而上的强势股
* 均线在下午2点半左右，创出新高，股价回落均线

## 分析

看到以上八个苛刻的条件，可能大部分还没找到股票，当天交易估计就结束了，别说交易了。说实话我刚看到这个视频时候，也是将信将疑，所以决定用程序对过去一年的历史数据进行校验。如果有效，再通过程序实现一个自动化交易的算法，完成自动化交易。

### 数据源

首先我们来分析一下我们需要哪些数据源：

* 股票列表，包括涨幅、量比、换手率、流通盘
* 股票K线数据，包括重要的均线
* 股票分时图

### 回归验证

我们主要针对2020年1月到2020年12月的数据，以及2021年上半年的数据进行回归交易，回归验证的流程为：

* 我们假设有10万本金进行上述交易
* 我们先根据上述条件进行股票过滤，如果当天能够筛选出股票，将资金平均分为3份，购买股票
* 卖出策略有很多种，我们先采取最简单的策略进行回归，我们假定在第二天上午10点30分将股票全部卖出
* 运行程序进行模拟，并计算总收益


### 实现方法

我们需要大量的历史交易数据，通过对网上资料的搜索，我发现tushare是目前提供最全的金融SDK，不仅仅是股票，还包括其他很多金融产品。tushare分为两个版本，一个为普通版本，一个为专业版本。普通版本虽然功能还能使用，但是逐步在废弃。专业版本是依靠积分机制来获取不同接口权限的，可以通过对社区贡献或者直接捐钱获取积分，不过这也不难理解，毕竟一个社区的良性发展需要资金支持。

Tushare旧版本的文档在这里：http://tushare.org/fundamental.html
全新版本的文档在：https://waditu.com/document/1

旧版本有很多接口已经废弃了，使用的时候会有提示。而新版本则需要先申请token，再进行使用，根据你的积分不同，你调用的接口和频度是不同的。同时tushare返回的格式直接就是pandas的DateFrame类型，可以直接进行排序或者过滤等数据操作，非常方便。目前对于一夜持股法的验证还在继续中，也欢迎有兴趣的同学参与。

